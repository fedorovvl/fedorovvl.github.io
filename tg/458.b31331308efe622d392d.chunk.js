"use strict";(this.webpackChunktweb=this.webpackChunktweb||[]).push([[458],{503:(t,e,n)=>{n.d(e,{I:()=>p,Z:()=>g});var i=n(6669),s=n(1544),l=n(8763),a=n(3735),o=n(1293),r=n(130),h=n(2325),u=n(6241),d=n(6535),c=n(3066);let f=()=>{document.addEventListener("paste",(t=>{const e=(0,l.Z)(t.target,'contenteditable="true"');if(!e)return;const n=!!e.dataset.noLinebreaks;let i,o;t.preventDefault();let r=(t.originalEvent||t).clipboardData.getData("text/plain"),h=!0,f=(t.originalEvent||t).clipboardData.getData("text/html");const p=t=>"messageEntityEmoji"===t._||"messageEntityLinebreak"===t._&&!n;if(n){const t=/[\r\n]/g;r=r.replace(t,""),f=f.replace(t,"")}if(f.trim()){f=f.replace(/<style([\s\S]*)<\/style>/,""),f=f.replace(/<!--([\s\S]*)-->/,"");const t=f.match(/<body>([\s\S]*)<\/body>/);t&&(f=t[1].trim());let e=document.createElement("span");e.innerHTML=f;let n=e.firstChild;for(;n;){let t=n.nextSibling;3===n.nodeType&&(n.nodeValue.trim()||n.remove()),n=t}const s=(0,a.Z)(e,!0);if(s.value.replace(/\s/g,"").length===r.replace(/\s/g,"").length){i=s.value,o=s.entities,h=!1;let t=(0,d.Z)(i);t=t.filter(p),(0,u.Z)(o,t)}}h&&(i=r,o=(0,d.Z)(i),o=o.filter(p));const g=(0,c.Z)(i,{entities:o});i=(0,s.Z)(g),window.document.execCommand("insertHTML",!1,i)})),f=null};var p;!function(t){t[t.Neutral=0]="Neutral",t[t.Valid=1]="Valid",t[t.Error=2]="Error"}(p||(p={}));class g{constructor(t={}){this.options=t,this.container=document.createElement("div"),this.container.classList.add("input-field"),this.required=t.required,this.validate=t.validate,void 0!==t.maxLength&&void 0===t.showLengthOn&&(t.showLengthOn=Math.min(40,Math.round(t.maxLength/3)));const{placeholder:e,maxLength:n,showLengthOn:i,name:s,plainText:l,canBeEdited:r=!0,autocomplete:u}=t,d=t.label||t.labelText,c=[];let p;if(l?(this.container.innerHTML=`\n      <input type="text" ${s?`name="${s}"`:""} autocomplete="${null!=u?u:"off"}" ${d?'required=""':""} class="input-field-input">\n      `,p=this.container.firstElementChild):(f&&f(),this.container.innerHTML=`\n      <div contenteditable="${String(!!r)}" class="input-field-input"></div>\n      `,p=this.container.firstElementChild,c.push((()=>{(0,o.Z)(p)&&(p.textContent="")}))),p.setAttribute("dir","auto"),t.inputMode&&(p.inputMode=t.inputMode),e&&(0,h.$d)(p,e,void 0,"placeholder"),d||e){const t=document.createElement("div");t.classList.add("input-field-border"),this.container.append(t)}if(d&&(this.label=document.createElement("label"),this.setLabel(),this.container.append(this.label)),n){const t=this.container.lastElementChild;let e=!1;const s=()=>{const s=p.classList.contains("error"),o=l?p.value.length:[...(0,a.Z)(p,!1).value].length,r=n-o,h=r<0;p.classList.toggle("error",h),h||r<=i?(this.setLabel(),t.append(` (${n-o})`),e||(e=!0)):(s&&!h||e)&&(this.setLabel(),e=!1)};c.push(s)}!t.withLinebreaks&&!l&&(p.dataset.noLinebreaks="1",p.addEventListener("keypress",(t=>{if("Enter"===t.key)return t.preventDefault(),!1}))),c.length&&p.addEventListener("input",(()=>{c.forEach((t=>t()))})),this.input=p}select(){this.value&&(this.options.plainText?this.input.select():function(t){const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e)}(this.input))}setLabel(){this.label.textContent="",this.options.labelText?(0,r.Z)(this.label,this.options.labelText):this.label.append((0,h.ag)(this.options.label,this.options.labelOptions))}get value(){return this.options.plainText?this.input.value:(0,a.Z)(this.input,!1).value}set value(t){this.setValueSilently(t,!0),(0,i.Z)(this.input,"input")}setValueSilently(t,e){this.options.plainText?this.input.value=t:this.input.innerHTML=t}isChanged(){return this.value!==this.originalValue}isValid(){return!this.input.classList.contains("error")&&(!this.validate||this.validate())&&(!this.required||!(0,o.Z)(this.input))}isValidToChange(){return this.isValid()&&this.isChanged()}setDraftValue(t="",e){this.options.plainText||(t=(0,s.Z)((0,c.Z)(t))),e?this.setValueSilently(t,!1):this.value=t}setOriginalValue(t="",e){this.originalValue=t,this.setDraftValue(t,e)}setState(t,e){e?(this.label.textContent="",this.label.append((0,h.ag)(e,this.options.labelOptions))):this.setLabel(),this.input.classList.toggle("error",!!(t&p.Error)),this.input.classList.toggle("valid",!!(t&p.Valid))}setError(t){this.setState(p.Error,t)}}},1544:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(4056);function s(t){return Array.from(t.childNodes).map((t=>3===t.nodeType?(0,i.Z)(t.textContent):t.outerHTML)).join("")}},8763:(t,e,n)=>{function i(t,e){return t.closest(`[${e}]`)}n.d(e,{Z:()=>i})},9041:(t,e,n)=>{n.d(e,{Z:()=>l,o:()=>i});const i={bold:{match:'[style*="bold"], [style*="font-weight: 700"], [style*="font-weight: 600"], [style*="font-weight:700"], [style*="font-weight:600"], b, strong',entityName:"messageEntityBold"},underline:{match:'[style*="underline"], u, ins',entityName:"messageEntityUnderline"},italic:{match:'[style*="italic"], i, em',entityName:"messageEntityItalic"},monospace:{match:'[style*="monospace"], [face*="monospace"], pre',entityName:"messageEntityCode"},strikethrough:{match:'[style*="line-through"], strike, del, s',entityName:"messageEntityStrike"},link:{match:"A:not(.follow)",entityName:"messageEntityTextUrl"},mentionName:{match:"A.follow",entityName:"messageEntityMentionName"},spoiler:{match:'[style*="spoiler"]',entityName:"messageEntitySpoiler"}},s=new Set(["DIV","P","BR","LI","SECTION","H6","H5","H4","H3","H2","H1","TR"]);function l(t,e,n,a,o,r,h={offset:0}){if(3===t.nodeType){let e=t.nodeValue;if(a===t?n.push(e.substr(0,o)+""+e.substr(o)):n.push(e),r&&e.length&&t.parentNode){const n=t.parentElement;for(const t in i){const s=i[t],l=n.closest(s.match+", [contenteditable]");null===(null==l?void 0:l.getAttribute("contenteditable"))&&("messageEntityTextUrl"===s.entityName?r.push({_:s.entityName,url:l.href,offset:h.offset,length:e.length}):"messageEntityMentionName"===s.entityName?r.push({_:s.entityName,offset:h.offset,length:e.length,user_id:l.dataset.follow.toUserId()}):r.push({_:s.entityName,offset:h.offset,length:e.length}))}}return void(h.offset+=e.length)}if(1!==t.nodeType)return;const u=a===t,d=s.has(t.tagName);if(d&&n.length)e.push(n.join("")),n.splice(0,n.length),++h.offset;else if(t instanceof HTMLImageElement){const e=t.alt;e&&(n.push(e),h.offset+=e.length)}u&&!o&&n.push("");const c=t.matches('[style*="table-cell"], th, td'),f=null==r?void 0:r.length;let p=t.firstChild;for(;p;)l(p,e,n,a,o,r,h),p=p.nextSibling;if(u&&o&&n.push(""),c&&t.nextSibling&&(n.push(" "),++h.offset,void 0!==f))for(let t=f,e=r.length;t<e;++t)++r[t].length;const g=n.length;d&&g&&(e.push(n.join("")),n.splice(0,g),++h.offset),g&&"P"===t.tagName&&t.nextSibling&&(e.push(""),++h.offset)}},3735:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(410),s=n(6875),l=n(1346),a=n(9041);function o(t,e=!0){const n=[],i=[],o=e?[]:void 0;(0,a.Z)(t,n,i,void 0,void 0,o),i.length&&n.push(i.join(""));let r=n.join("\n");return r=r.replace(/\u00A0/g," "),(null==o?void 0:o.length)&&((0,s.Z)(o),(0,l.Z)(o)),{value:r,entities:o}}i.GO.getRichValue=o},1293:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(3735);function s(t){return t.hasAttribute("contenteditable")||"INPUT"!==t.tagName?!(0,i.Z)(t,!1).value.trim():!t.value.trim()}},5565:(t,e,n)=>{function i(t,e){if("string"==typeof e)return void(t.innerHTML=e);const n=t.firstChild;n?t.lastChild===n?n.replaceWith(e):(t.textContent="",t.append(e)):t.append(e)}n.d(e,{Z:()=>i})},130:(t,e,n)=>{function i(t,e){t.setAttribute("dir","auto"),"string"==typeof e?e?t.innerHTML=e:t.textContent="":(t.textContent="",t.append(e))}n.d(e,{Z:()=>i})},6875:(t,e,n)=>{n.d(e,{Z:()=>s});const i=new Set(["messageEntityBold","messageEntityItalic","messageEntityCode","messageEntityPre","messageEntityUnderline","messageEntityStrike","messageEntityBlockquote","messageEntitySpoiler"]);function s(t){for(let e=0;e<t.length;++e){const n=t[e];let s=-1;do{if(s=t.findIndex(((t,s)=>i.has(t._)&&s!==e&&t._===n._&&t.offset-n.length===n.offset)),-1!==s){const e=t[s];n.length+=e.length,t.splice(s,1)}}while(-1!==s)}}},8859:(t,e,n)=>{n.d(e,{Z:()=>l});var i=n(2423);const s=new Set(["messageEntityPre","messageEntityCode"]);function l(t,e){let n=-1;return t.find((t=>(s.has(t._)&&(n=t.offset+t.length),e.offset<n&&!i.tY.has(e._)||(e._===t._||!i.tY.has(e._)&&!i.tY.has(t._))&&(e.offset>=t.offset&&e.length+e.offset<=t.length+t.offset))))}},6241:(t,e,n)=>{n.d(e,{Z:()=>l});var i=n(8859),s=n(1346);function l(t,e){const n=e.filter((e=>!(0,i.Z)(t,e)));t.push(...n),(0,s.Z)(t);for(let e=0;e<t.length;++e){const n=t[e];if("messageEntityEmoji"===n._){const i=t[e+1];i&&i.offset<n.offset+n.length&&(n.length=i.offset-n.offset)}}return t}},1346:(t,e,n)=>{function i(t){t.sort(((t,e)=>t.offset-e.offset||e.length-t.length))}n.d(e,{Z:()=>i})},3066:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(3178);function s(t,e={}){return t?(0,i.Z)(t,{entities:e.entities,noLinks:!0,wrappingDraft:!0,passEntities:{messageEntityTextUrl:!0,messageEntityMentionName:!0}}):(0,i.Z)("")}}}]);
//# sourceMappingURL=458.b31331308efe622d392d.chunk.js.map